  
  [1X2 [33X[0;0YPolygonal Structures[133X[101X
  
  [33X[0;0YThis  chapter  presents the different ways in which surfaces are used in the
  [9XSimplicialSurfaces[109X-package. More accurately, it presents structures that are
  build  from  polygons  (note  that  these  can  be  much  more  general than
  simplicial surfaces). We employ two different models for these structures:[133X
  
  [31X1[131X   [33X[0;6YDescription  by  incidence  geometry.  This  leads  to  the concept of
        [9XPolygonalComplex[109X  (section  [14X2.1[114X).  The  requirements  for  these to be
        surfaces are explained in section [14X2.3[114X.[133X
  
  [31X2[131X   [33X[0;6YIf  incidence  geometry  is  not  sufficient  to  describe a polygonal
        structure,  additional  information  (a barycentric subdivision of the
        faces)    can    be    used.    This   leads   to   the   concept   of
        [9XTwistedPolygonalComplex[109X (section [14X2.2[114X).[133X
  
  [33X[0;0Y[13XPolygonal  Complexes[113X are structures that are build from polygons, like shown
  in the following figure (for the precise definition, see section [14X2.1[114X). Image
  omitted  in terminal text Surfaces are a special case of polygonal complexes
  and  the  package  provides  functionality  to determine whether a polygonal
  complex is a surface.[133X
  
  
  [1X2.1 [33X[0;0YPolygonal Complexes (pure incidence geometry)[133X[101X
  
  [33X[0;0YA  polygonal complex is defined by a two-dimensional incidence geometry that
  fulfills  some  regularity conditions (the complete definition will be given
  at  the  end of this section in definition [14X2.1-1[114X). We will exemplify this by
  the  following  surface. Image omitted in terminal text In a two-dimensional
  incidence geometry we have a set [22XV[122X of vertices, a set [22XE[122X of edges and a set [22XF[122X
  of  faces. If we label our surface like this, Image omitted in terminal text
  we have the sets[133X
  
  [33X[0;0Y[22XV = {2, 3, 5, 7, 11}[122X[133X
  
  [33X[0;0Y[22XE = {6, 8, 9, 10, 12, 13}[122X[133X
  
  [33X[0;0Y[22XF = {I, IV}[122X.[133X
  
  [33X[0;0YThese  sets  can't  encode  the  surface on their own. The relations between
  vertices,  edges,  and  faces  are  also  necessary.  Therefore  we define a
  transitive  relation in the union of [22XV Ã— E[122X, [22XV Ã— F[122X, and [22XE Ã— F[122X, where [22X(a,b)[122X is
  in  the  relation  if  and only if [22Xa[122X is incident to [22Xb[122X. Since the relation is
  transitive,  it  is  sufficient to specify the tuples in [22XV Ã— E[122X and [22XE Ã— F[122X. In
  our example the relation is generated by[133X
  
  [33X[0;0Y[22X{  (2,6), (2,8), (3,8), (3,9), (3,12), (5,6), (5,9), (5,10), (7,12), (7,13),
  (11,10), (11,13)}[122X[133X
  
  [33X[0;0Yand[133X
  
  [33X[0;0Y[22X{ (6,I), (8,I), (9,I), (9,IV), (10,IV), (12,IV), (13,IV) }[122X.[133X
  
  [33X[0;0YHowever,  we  do  not  permit  arbitrary  incidence relations but only those
  satisfying certain regularity conditions (like in our example). For example,
  every  edge should consist of exactly two vertices (more formally, for every
  edge  there  should  be exactly two vertices that are incident to it). Image
  omitted in terminal text If we try to generalize this condition to the faces
  we  encounter  some  difficulties. For example, if we only enforce that each
  face  has  exactly three edges and three vertices, it would be possible that
  two  of  those edges share all of their vertices. Therefore even the case of
  triangles is quite complicated. Image omitted in terminal text We will solve
  this  problem  by  imposing a cyclic ordering on the vertices and edges that
  are incident to each face, such that those are compatible with the incidence
  structure. Since this definition is equally valid for all polygons (not just
  triangles), we formally define:[133X
  
  [30X    [33X[0;6YFor  every face the number of incident vertices is equal to the number
        of  incident  edges.  Additionally  there  is  an  enumeration  of the
        vertices  ([22Xv_1, v_2, ..., v_k[122X) and the edges ([22Xe_1, e_2, ..., e_k[122X) such
        that  the vertices [22Xv_i[122X and [22Xv_{i+1}[122X are incident to the edge [22Xe_i[122X (where
        we read indices [22Xmod k[122X).[133X
  
  [33X[0;0YImage omitted in terminal text With these conditions we have guaranteed that
  all  edges and faces behave as in our previous example. But they still allow
  the  possibility  of  an  incidence  relation  where we have vertices but no
  faces.  Since  we  want  to  exclude  singular  cases  like  this  from  our
  considerations,  we  require  that  every vertex is incident to at least one
  edge and that every edge is incident to at least one face.[133X
  
  
  [1X2.1-1 [33X[0;0YDefinition (polygonal complex)[133X[101X
  
  [33X[0;0YA  [13Xpolygonal  complex[113X  is a two-dimensional incidence geometry consisting of
  vertices,  edges,  and  faces such that the following conditions hold (for a
  more intuitive explanation see section [14X2.1[114X):[133X
  
  [31X1[131X   [33X[0;6YFor every edge there are exactly two vertices that are incident to it.[133X
  
  [31X2[131X   [33X[0;6YFor  every face the number of incident vertices is equal to the number
        of  incident  edges.  Additionally  there  is  an  enumeration  of the
        vertices  ([22Xv_1, v_2, ..., v_k[122X) and the edges ([22Xe_1, e_2, ..., e_k[122X) such
        that  the vertices [22Xv_i[122X and [22Xv_{i+1}[122X are incident to the edge [22Xe_i[122X (where
        we read indices [22Xmod k[122X).[133X
  
  [31X3[131X   [33X[0;6YEvery  vertex  is  incident to an edge and every edge is incident to a
        face.[133X
  
  [33X[0;0YIt  is  now easy to verify that the examples in the picture Image omitted in
  terminal text are all polygonal complexes.[133X
  
  [1X2.1-2 IsPolygonalComplex[101X
  
  [33X[1;0Y[29X[2XIsPolygonalComplex[102X( [3Xobject[103X ) [32X property[133X
  [6XReturns:[106X  [33X[0;10Y[9Xtrue[109X or [9Xfalse[109X[133X
  
  [33X[0;0YChecks  whether  [3Xobject[103X  is  a polygonal complex. A polygonal complex can be
  informally described as a structure that is constructed from polygons.[133X
  
  [33X[0;0YMore formally (for a more extensive explanation see section [14X2.1[114X) a polygonal
  complex is a two-dimensional incidence geometry of vertices, edges and faces
  such that the following conditions hold:[133X
  
  [31X1[131X   [33X[0;6YEvery edge has exactly two incident vertices.[133X
  
  [31X2[131X   [33X[0;6YFor  every  face  the  incident edges and vertices form a polygon (see
        definition [14X2.1-1[114X).[133X
  
  [31X3[131X   [33X[0;6YEvery  vertex  is  incident to an edge and every edge is incident to a
        face.[133X
  
  
  [1X2.2 [33X[0;0YTwisted polygonal complexes and surfaces[133X[101X
  
  [33X[0;0YWhile  polygonal  complexes  are  quite  general,  they  can't  describe all
  possible  triangulations  of  a  topological  surface.  For  example, we can
  construct  a  torus  from  a  single  polygon  by starting with a square and
  identifying  opposite  edges.  Image  omitted  in  terminal  text  Since all
  vertices  of  the  square collapse into a single vertex, it is impossible to
  describe  this  situation  by a polygonal complex (as every edge needs to be
  incident to [13Xexactly two[113X vertices). Structures like these appear naturally in
  several cases, for example.[133X
  
  [30X    [33X[0;6YConstruction of surfaces from the coset action of a group.[133X
  
  [30X    [33X[0;6YConstruction of the geodesic dual.[133X
  
  [33X[0;0YIn these cases, the more general formalism of [13Xtwisted polygonal complexes[113X is
  helpful. To interpret the torus as a twisted polygonal complex, we subdivide
  it  barycentrically.  Image  omitted  in  terminal  text The small triangles
  within each face are called [13Xchambers[113X. A twisted polygonal complex stores the
  incidences between vertices, edges, and faces (like a polygonal complex). In
  addition, it also stores a set of chambers, together with their adjacencies.
  Each chamber can be adjacent to another chamber along each of its edges.[133X
  
  [30X    [33X[0;6YAlong the shortest edge, each chamber is adjacent to exactly one other
        chamber.  We  call  these chambers [13X0-adjacent[113X. In the torus, the pairs
        are [22X(1,2)(3,4)(5,6)(7,8)[122X.[133X
  
  [30X    [33X[0;6YAlong  the longest edge, each chamber is adjacent to exactly one other
        chamber.  We  call  these chambers [13X1-adjacent[113X. In the torus, the pairs
        are [22X(1,8)(2,3)(4,5)(6,7)[122X.[133X
  
  [30X    [33X[0;6YAlong  the  middle  edge,  a  chamber may be adjacent to any number of
        other  chambers. All of them are called [13X2-adjacent[113X. In the torus, each
        chamber   is   2-adjacent  to  exactly  one  chamber.  The  pairs  are
        [22X(1,6)(2,5)(3,8)(4,7)[122X.[133X
  
  [33X[0;0YBoth  0-adjacency  and 1-adjacency can be interpreted as involutions without
  fixed  points  (i.e. elements from the symmetric group on the chambers). The
  2-adjacency  can  be represented by an equivalence relation on the chambers.
  Naturally, we cannot pick any involutions and equivalence relations:[133X
  
  [30X    [33X[0;6YApplying  the  0-adjacency-involution does not change the edge and the
        face of a given chamber.[133X
  
  [30X    [33X[0;6YApplying the 1-adjacency-involution does not change the vertex and the
        face of a given chamber.[133X
  
  [30X    [33X[0;6YIf  two  chambers  are 2-adjacent, they have the same vertex and edge.
        Furthermore,  applying  the  0-adjacency-involution  to  both produces
        2-adjacent chambers.[133X
  
  [30X    [33X[0;6YIf  two chambers have the same edge, they are either 2-adjacent or the
        first  chamber  is 2-adjacent to the chamber that arises from applying
        the 0-adjacency-involution to the second chamber.[133X
  
  [30X    [33X[0;6YIf  two  chambers have the same face, we can obtain the second chamber
        from    the    first    chamber    by    repeatedly    applying    the
        0-adjacency-involution and 1-adjacency-involution.[133X
  
  [1X2.2-1 IsTwistedPolygonalComplex[101X
  
  [33X[1;0Y[29X[2XIsTwistedPolygonalComplex[102X( [3Xobject[103X ) [32X property[133X
  [6XReturns:[106X  [33X[0;10Y[9Xtrue[109X or [9Xfalse[109X[133X
  
  [33X[0;0YChecks  whether  [3Xobject[103X  is a twisted polygonal complex. A twisted polygonal
  complex  can be informally described as a structure that is constructed from
  polygons,  where  the polygons may be [13Xtwisted[113X (e.g. there could be a polygon
  with  one  vertex  and  three  edges).  More  formally (for a more extensive
  explanation see Section [14X2.2[114X) a twisted polygonal complex is TODO[133X
  
  [33X[0;0YTODO explain how to work with it[133X
  
  
  [1X2.3 [33X[0;0YPolygonal and simplicial surfaces[133X[101X
  
  [33X[0;0YPolygonal surfaces are polygonal complexes (compare section [14X2.1[114X) that behave
  like  surfaces  (two-dimensional manifolds with boundary). For example, they
  arise  from  the discretisation of a continuous surface. Simplicial surfaces
  are polygonal surfaces, where all polygons are triangles.[133X
  
  [33X[0;0YThere  are two properties that distinguish polygonal surfaces from polygonal
  complexes:[133X
  
  [31X1[131X   [33X[0;6YThere  are  no  ramified edges, i.e. every edge is incident to at most
        two  faces.  This  excludes  cases like three triangles that share one
        edge. Image omitted in terminal text[133X
  
  [31X2[131X   [33X[0;6YThere  are  no ramified vertices. We will formalize this below but the
        aim of this condition is to exclude cases like these: Image omitted in
        terminal text[133X
  
  [33X[0;0YIf  only  the  first  condition  is  fulfilled,  we have a [13Xpolygonal complex
  without edge ramifications[113X.[133X
  
  [1X2.3-1 IsNotEdgeRamified[101X
  
  [33X[1;0Y[29X[2XIsNotEdgeRamified[102X( [3Xcomplex[103X ) [32X property[133X
  [6XReturns:[106X  [33X[0;10Y[9Xtrue[109X or [9Xfalse[109X[133X
  
  [33X[0;0YChecks   whether   the   twisted  polygonal  complex  [3Xcomplex[103X  has  no  edge
  ramifications.[133X
  
  [33X[0;0YIf [3Xcomplex[103X is a polygonal complex, this means that every edge is incident to
  at most two faces.[133X
  
  [33X[0;0YIf  [3Xcomplex[103X is a twisted polygonal complex, this means that every chamber is
  2-adjacent to at most one other chamber.[133X
  
  [33X[0;0YWe  now  proceed  to  formalize the second condition. Intuitively we want to
  distinguish  between  the  different coloured faces in these examples: Image
  omitted in terminal text They can be distinguished by the fact that faces of
  the  same  colour  are  connected  by  edges  that are incident to the given
  vertex. More formally:[133X
  
  
  [1X2.3-2 [33X[0;0YDefinition (Umbrella-path around a vertex)[133X[101X
  
  [33X[0;0YAn  [13Xumbrella-path around the vertex [22XV[122X[113X is a tuple [22X(e_1,f_1,e_2,f_2, ..., e_n,
  f_n, e_{n+1})[122X such that:[133X
  
  [30X    [33X[0;6YThe [22Xf_i[122X are pairwise disjoint faces incident to [22XV[122X.[133X
  
  [30X    [33X[0;6YThe  [22Xe_i[122X  are pairwise disjoint edges incident to [22XV[122X (with the possible
        exception of [22Xe_1 = e_{n+1}[122X in the case [22Xn > 1[122X).[133X
  
  [30X    [33X[0;6YThe edges [22Xe_i[122X and [22Xe_{i+1}[122X are incident to [22Xf_i[122X for all [22Xi[122X.[133X
  
  [33X[0;0YIf  [22Xe_1  =  e_{n+1}[122X  the  umbrella-path  is  called [13Xclosed[113X. Image omitted in
  terminal text[133X
  
  [33X[0;0YWith this definition in mind we can explicate the second property:[133X
  
  [30X    [33X[0;6YFor  every vertex [22XV[122X all incident edges and faces can be arranged in an
        umbrella-path  around  [22XV[122X (compare definition [14X2.3-2[114X), i.e. there are no
        vertex-ramifications.[133X
  
  [33X[0;0YFor  generic  polygonal complexes without edge ramifications we can't expect
  to  get  exactly  one umbrella. In our examples above all incident edges and
  faces could be represented by two umbrellas.[133X
  
  [1X2.3-3 IsNotVertexRamified[101X
  
  [33X[1;0Y[29X[2XIsNotVertexRamified[102X( [3Xcomplex[103X ) [32X property[133X
  [6XReturns:[106X  [33X[0;10Y[9Xtrue[109X or [9Xfalse[109X[133X
  
  [33X[0;0YChecks   whether  the  twisted  polygonal  complex  [3Xcomplex[103X  has  no  vertex
  ramifications,  i.e.  that  there  is exactly one maximal umbrella for every
  vertex.[133X
  
  [33X[0;0YIn  general,  we can always find a set of umbrella of a vertex such that all
  edges  and  faces  incident  to  that  vertex  lie  in  exactly one of those
  umbrellas. This is called the [13Xumbrella partition[113X of the vertex (we will talk
  more about this topic in section [14X3.4[114X).[133X
  
  [1X2.3-4 IsPolygonalSurface[101X
  
  [33X[1;0Y[29X[2XIsPolygonalSurface[102X( [3Xobject[103X ) [32X property[133X
  [6XReturns:[106X  [33X[0;10Y[9Xtrue[109X or [9Xfalse[109X[133X
  
  [33X[0;0YChecks  whether  [3Xobject[103X  (a  polygonal  complex)  is  a  polygonal  surface.
  Informally  a  polygonal  surface is a surface (with boundary) that is build
  only from polygons.[133X
  
  [33X[0;0YMore  formally  (for  more  details and examples see sections [14X2.1[114X and [14X2.3[114X) a
  polygonal  surface  is  a  two-dimensional  incidence  geometry of vertices,
  edges, and faces such that the following conditions hold:[133X
  
  [31X1[131X   [33X[0;6YEvery edge has exactly two incident vertices.[133X
  
  [31X2[131X   [33X[0;6YFor  every  face  the  incident edges and vertices form a polygon (see
        definition [14X2.1-1[114X).[133X
  
  [31X3[131X   [33X[0;6YEvery  vertex  is  incident to an edge and every edge is incident to a
        face.[133X
  
  [31X4[131X   [33X[0;6YEvery  edge  is  incident  to  at  most  two  faces, i.e. there are no
        edge-ramifications.[133X
  
  [31X5[131X   [33X[0;6YFor  every vertex [22XV[122X all incident edges and faces can be arranged in an
        umbrella-path  around  [22XV[122X (compare definition [14X2.3-2[114X), i.e. there are no
        vertex-ramifications.[133X
  
  [1X2.3-5 IsSimplicialSurface[101X
  
  [33X[1;0Y[29X[2XIsSimplicialSurface[102X( [3Xobject[103X ) [32X property[133X
  [6XReturns:[106X  [33X[0;10Y[9Xtrue[109X or [9Xfalse[109X[133X
  
  [33X[0;0YChecks  whether  [3Xobject[103X  (a  polygonal  complex)  is  a  simplicial surface.
  Informally  a  simplicial surface is a surface (with boundary) that is build
  only from triangles.[133X
  
  [33X[0;0YMore  formally  (for  more  details and examples see sections [14X2.1[114X and [14X2.3[114X) a
  simplicial  surface  is  a  two-dimensional  incidence geometry of vertices,
  edges, and faces such that the following conditions hold:[133X
  
  [31X1[131X   [33X[0;6YEvery edge has exactly two incident vertices.[133X
  
  [31X2[131X   [33X[0;6YFor  every  face  the incident edges and vertices form a triangle (see
        definition [14X2.1-1[114X).[133X
  
  [31X3[131X   [33X[0;6YEvery  vertex  is  incident to an edge and every edge is incident to a
        face.[133X
  
  [31X4[131X   [33X[0;6YEvery  edge  is  incident  to  at  most  two  faces, i.e. there are no
        edge-ramifications.[133X
  
  [31X5[131X   [33X[0;6YFor  every vertex [22XV[122X all incident edges and faces can be arranged in an
        umbrella-path  around  [22XV[122X (compare definition [14X2.3-2[114X), i.e. there are no
        vertex-ramifications.[133X
  
